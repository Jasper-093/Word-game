<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>è¶£å‘³å–®å­—é»˜å¯«ï¼ˆå°å­¸ç‰ˆï¼‰</title>
<style>
  /* --------- åŸºæœ¬æ¨£å¼ï¼ˆå…’ç«¥å‹å¥½ï¼‰ --------- */
  :root{
    --bg: #f0f8ff;
    --card: #ffffff;
    --accent: #4dabf7;
    --muted: #6c757d;
    --good: #2b8a3e;
    --bad: #c92a2a;
  }
  *{box-sizing: border-box}
  body{
    margin:0;
    font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background: linear-gradient(135deg,#e6f2ff 0%, #f8fbff 100%);
    color:#123;
    padding:18px;
    -webkit-font-smoothing:antialiased;
  }
  .wrap{
    max-width: 1000px;
    margin: 8px auto;
    background: var(--card);
    border-radius: 20px;
    box-shadow: 0 12px 30px rgba(15,40,80,0.08);
    padding: 22px;
    overflow: hidden;
  }

  header{
    text-align:center;
    padding-bottom: 12px;
    border-bottom: 3px dashed #d6eaff;
  }
  h1{
    margin: 8px 0;
    font-size: 2rem;
    color:#0b66b2;
  }
  p.lead{
    margin:0;
    color:var(--muted);
    font-size: 1rem;
  }

  .game {
    display:flex;
    gap:18px;
    margin-top:18px;
    flex-wrap:wrap;
  }

  /* å·¦å´ä¸»å€ï¼šé¡Œç›®ã€è¼¸å…¥ã€å­—æ¯é¢æ¿ */
  .left{
    flex:1 1 520px;
    min-width:320px;
  }
  .card{
    background: #fbfeff;
    border-radius: 14px;
    padding: 16px;
    box-shadow: 0 6px 18px rgba(10,30,80,0.04);
    border: 3px solid rgba(150,200,255,0.25);
    margin-bottom: 14px;
  }

  .chinese {
    font-size: 3rem;
    color: #1b6fb3;
    font-weight:700;
    text-align:center;
    padding: 10px 6px;
  }

  .controls{
    display:flex;
    gap:10px;
    margin-top:8px;
    justify-content: center;
    flex-wrap:wrap;
  }
  button.btn{
    border:none;
    padding:12px 16px;
    border-radius:12px;
    font-weight:700;
    cursor:pointer;
    font-size:1rem;
    box-shadow: 0 6px 12px rgba(10,30,80,0.06);
  }
  .btn-start{ background:#40c057; color:white; }
  .btn-submit{ background: #339af0; color:white; }
  .btn-restart{ background: #ff922b; color:white; }
  .btn-disabled{ opacity:0.5; pointer-events:none; }

  .timer{
    text-align:center;
    margin-top:8px;
  }
  .timer .time{
    font-size:2.6rem;
    font-weight:900;
    color:#ff7b00;
    letter-spacing:2px;
  }
  .timer .label{ color:var(--muted); font-weight:700; }

  .answer-input{
    display:flex;
    gap:8px;
    justify-content:center;
    align-items:center;
    margin-top:12px;
  }
  input[type="text"].answer {
    width:80%;
    max-width:480px;
    padding:14px 12px;
    font-size:1.6rem;
    text-align:center;
    border-radius:12px;
    border:3px solid #a6d1ff;
    background:#f0fbff;
    font-weight:700;
    letter-spacing: 2px;
    color:#0b6fb2;
  }
  input.answer:focus{ outline: none; box-shadow:0 0 0 6px rgba(28,126,214,0.08); }

  .letters {
    margin-top:16px;
    display:grid;
    grid-template-columns: repeat(9, 1fr);
    gap:8px;
    justify-items:stretch;
  }
  @media (max-width:900px){ .letters{ grid-template-columns: repeat(7, 1fr); } }
  @media (max-width:520px){ .letters{ grid-template-columns: repeat(6, 1fr); } }

  .letter {
    user-select:none;
    border-radius:10px;
    padding:10px 6px;
    font-weight:900;
    font-size:1.2rem;
    text-align:center;
    cursor:pointer;
    color:white;
    box-shadow: 0 6px 10px rgba(10,30,80,0.06);
    transition: transform .08s;
  }
  .letter:active{ transform: translateY(2px) scale(.99); }
  .letter.disabled { opacity:0.4; pointer-events:none; transform:none; }

  /* å³å´ï¼šé€²åº¦/åˆ†æ•¸/åˆ—è¡¨ */
  .right{
    width:320px;
    min-width:260px;
  }
  .stat-row{
    display:flex;
    gap:8px;
    justify-content:space-between;
    margin-bottom:10px;
  }
  .stat{
    flex:1;
    background:#fff;
    padding:12px;
    border-radius:10px;
    text-align:center;
    border:3px solid rgba(99,230,190,0.18);
  }
  .stat h4{ margin:0; font-size:1.6rem; color:#2b8aef; }
  .stat p{ margin:4px 0 0; color:var(--muted); font-weight:700; }

  .progress-bar{
    height:18px;
    background:#eef6f2;
    border-radius:12px;
    overflow:hidden;
    margin-top:10px;
    border:3px solid rgba(156,219,203,0.18);
  }
  .progress-fill{
    height:100%;
    width:0%;
    background: linear-gradient(90deg,#20c997,#63e6be);
    transition: width .5s ease;
  }

  .feedback{
    margin-top:12px;
    padding:12px;
    border-radius:10px;
    text-align:center;
    font-weight:900;
    font-size:1.1rem;
    min-height:56px;
  }
  .feedback.ok{ background:#d3f9d8; color: #2b8a3e; border:3px solid #69db7c; }
  .feedback.bad{ background:#ffe3e3; color:#c92a2a; border:3px solid #ff8787; }
  .word-list{
    margin-top:14px;
    padding-top:8px;
    border-top:2px dashed #e6eefc;
  }
  .word-list h3{ text-align:center; color:#416; }
  .word-pair{
    display:flex;
    justify-content:space-between;
    gap:10px;
    padding:6px 8px;
    border-radius:8px;
    background:#fbfdff;
    margin-bottom:6px;
    border:1px solid #f0f6ff;
  }

  /* å°æç¤º */
  .hint{
    margin-top:8px;
    text-align:center;
    color:#555;
    font-weight:700;
  }

  footer{
    margin-top:16px;
    text-align:center;
    color:var(--muted);
    font-size:.95rem;
  }
</style>
</head>
<body>
  <div class="wrap" role="application" aria-label="å–®å­—é»˜å¯«éŠæˆ²">
    <header>
      <h1>è¶£å‘³å–®å­—é»˜å¯«ï¼ˆå°å­¸ç‰ˆï¼‰</h1>
      <p class="lead">é¡¯ç¤ºä¸­æ–‡ï¼Œè«‹è¼¸å…¥å®Œæ•´è‹±æ–‡å–®å­—ã€‚å¯é»å­—æ¯æ–¹å¡Šæˆ–ç›´æ¥éµç›¤è¼¸å…¥ã€‚ç¥ä½ ç©å¾—é–‹å¿ƒï¼</p>
    </header>

    <main class="game" id="app">
      <section class="left">
        <div class="card" aria-live="polite">
          <div class="chinese" id="chineseWord">æŒ‰ã€Œé–‹å§‹ã€é¡¯ç¤ºä¸­æ–‡</div>

          <div class="controls" id="topControls">
            <button class="btn btn-start" id="startBtn" aria-pressed="false">é–‹å§‹</button>
            <button class="btn btn-submit btn-disabled" id="submitBtn">æäº¤</button>
            <button class="btn btn-restart" id="restartBtn">é‡æ–°é–‹å§‹</button>
          </div>

          <div class="timer" role="timer" aria-atomic="true">
            <div class="time" id="timeDisplay">00</div>
            <div class="label">å€’æ•¸ç§’æ•¸</div>
          </div>

          <div class="answer-input">
            <input type="text" class="answer" id="answerInput" autocomplete="off" inputmode="latin" aria-label="è¼¸å…¥å–®å­—" placeholder="è¼¸å…¥æˆ–é»é¸å­—æ¯..." />
          </div>

          <div class="hint" id="hintText">æç¤ºï¼šå¯ç”¨æ»‘é¼ é»å­—æ¯æˆ–ç›´æ¥éµç›¤è¼¸å…¥ã€‚æŒ‰ Enter å¯æäº¤ã€‚</div>

          <!-- å­—æ¯æŒ‰éˆ• -->
          <div class="letters card" id="lettersPanel" aria-label="å­—æ¯é¢æ¿">
            <!-- JS æœƒå‹•æ…‹ç”Ÿæˆ A-Z æŒ‰éˆ• -->
          </div>

          <div style="margin-top:12px; text-align:center; color:#666; font-weight:700;">
            å·²è¼¸å…¥ï¼š<span id="typedDisplay">ï¼ˆç„¡ï¼‰</span>
          </div>
        </div>

        <!-- é¡¯ç¤ºç­”æ¡ˆèˆ‡æç¤º -->
        <div class="card" id="bottomCard" aria-live="polite">
          <div class="feedback" id="feedbackArea">æº–å‚™å¥½äº†å—ï¼ŸæŒ‰é–‹å§‹ï¼</div>
        </div>
      </section>

      <aside class="right">
        <div class="card">
          <div class="stat-row">
            <div class="stat">
              <h4 id="scoreVal">0</h4>
              <p>å¾—åˆ†</p>
            </div>
            <div class="stat">
              <h4 id="attemptVal">0</h4>
              <p>ç­”é¡Œæ•¸</p>
            </div>
          </div>

          <div class="progress-label" style="font-weight:900; color:#0b6fb2; margin-top:4px;">
            é€²åº¦
          </div>
          <div class="progress-bar" aria-hidden="false">
            <div class="progress-fill" id="progressFill"></div>
          </div>

          <div style="margin-top:10px;">
            <button class="btn btn-start" id="showAnswerBtn" style="width:100%;">é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆï¼ˆæç¤ºï¼‰</button>
          </div>
        </div>

        <div class="card word-list">
          <h3>å–®å­—åˆ—è¡¨ï¼ˆä¸­ â€” è‹±ï¼‰</h3>
          <div id="wordList">
            <!-- JS å¡«å……åå–® -->
          </div>
        </div>
      </aside>
    </main>

    <footer>
      <small>è¨­è¨ˆçµ¦å°å­¸ç”Ÿï¼šå¤§æŒ‰éˆ•ã€ç°¡å–®æ–‡å­—ã€è‰²å½©å‹å–„ã€‚ç¥å­¸ç¿’æ„‰å¿«ï¼</small>
    </footer>
  </div>

<script>
/*
  å®Œæ•´å–®æ–‡ä»¶ JSï¼š
  - æ”¯æ´é»å­—æ¯æˆ–éµç›¤è¼¸å…¥
  - å€’è¨ˆæ™‚ï¼ˆæ¯é¡Œå¯è¨­å®šç§’æ•¸ï¼‰
  - éš¨æ©Ÿé¡Œç›®ï¼ˆå¯èª¿æ•´é¡Œç›®æ¬¡æ•¸ï¼‰
  - æª¢æŸ¥ç­”æ¡ˆï¼ˆå¤§å°å¯«ä¸æ•æ„Ÿï¼‰
  - é¡¯ç¤ºé€²åº¦ã€å¾—åˆ†ã€ç­”é¡Œæ•¸
*/

(function(){
  // --- å¯èª¿åƒæ•¸ ---
  const QUESTION_COUNT = 20;       // ä¸€å›åˆçš„é¡Œç›®æ•¸ï¼ˆé€²åº¦æ¢æ»¿ï¼‰
  const DEFAULT_SECONDS = 18;      // æ¯é¡Œå€’æ•¸ç§’æ•¸
  const WORDS = [
    // å¸¸ç”¨å°å­¸è©å½™ï¼šä¸­æ–‡ â€” è‹±æ–‡
    {c:'è˜‹æœ', e:'apple'},
    {c:'æ©˜å­', e:'orange'},
    {c:'é¦™è•‰', e:'banana'},
    {c:'è‘¡è„', e:'grape'},
    {c:'è¥¿ç“œ', e:'watermelon'},
    {c:'ç‹—', e:'dog'},
    {c:'è²“', e:'cat'},
    {c:'é­š', e:'fish'},
    {c:'é³¥', e:'bird'},
    {c:'è€å¸«', e:'teacher'},
    {c:'å­¸ç”Ÿ', e:'student'},
    {c:'æ›¸', e:'book'},
    {c:'é‰›ç­†', e:'pencil'},
    {c:'æ©¡çš®', e:'eraser'},
    {c:'å­¸æ ¡', e:'school'},
    {c:'å®¶', e:'home'},
    {c:'é–€', e:'door'},
    {c:'çª—æˆ¶', e:'window'},
    {c:'æ¡Œå­', e:'table'},
    {c:'æ¤…å­', e:'chair'},
    {c:'çƒ', e:'ball'},
    {c:'é›¨', e:'rain'},
    {c:'å¤ªé™½', e:'sun'},
    {c:'æœˆäº®', e:'moon'},
    {c:'æ˜Ÿæ˜Ÿ', e:'star'},
    {c:'è»Š', e:'car'},
    {c:'èˆ¹', e:'boat'},
    {c:'é£›æ©Ÿ', e:'plane'},
    {c:'è˜‘è‡', e:'mushroom'},
    {c:'ç´…è‰²', e:'red'},
    {c:'è—è‰²', e:'blue'},
    {c:'é»ƒè‰²', e:'yellow'},
    {c:'ç¶ è‰²', e:'green'},
    {c:'é»‘è‰²', e:'black'},
    {c:'ç™½è‰²', e:'white'},
    {c:'åª½åª½', e:'mother'},
    {c:'çˆ¸çˆ¸', e:'father'},
    {c:'å§å§', e:'sister'},
    {c:'å“¥å“¥', e:'brother'},
    {c:'æ™‚é–“', e:'time'},
    {c:'æ°´', e:'water'},
    {c:'ç‰›å¥¶', e:'milk'},
    {c:'è›‹', e:'egg'},
    {c:'éºµåŒ…', e:'bread'},
    {c:'ç³–', e:'sugar'},
    {c:'è˜‹æœæ´¾', e:'pie'},
    {c:'é†«ç”Ÿ', e:'doctor'},
    {c:'åœ–æ›¸é¤¨', e:'library'},
    {c:'å‹•ç‰©', e:'animal'},
    {c:'åŸå¸‚', e:'city'},
    {c:'é„‰æ‘', e:'village'},
    {c:'ç­ç´š', e:'class'},
    {c:'æœ‹å‹', e:'friend'}
  ];

  // --- DOM åƒè€ƒ ---
  const startBtn = document.getElementById('startBtn');
  const submitBtn = document.getElementById('submitBtn');
  const restartBtn = document.getElementById('restartBtn');
  const timeDisplay = document.getElementById('timeDisplay');
  const chineseWord = document.getElementById('chineseWord');
  const answerInput = document.getElementById('answerInput');
  const lettersPanel = document.getElementById('lettersPanel');
  const feedbackArea = document.getElementById('feedbackArea');
  const scoreVal = document.getElementById('scoreVal');
  const attemptVal = document.getElementById('attemptVal');
  const progressFill = document.getElementById('progressFill');
  const typedDisplay = document.getElementById('typedDisplay');
  const showAnswerBtn = document.getElementById('showAnswerBtn');
  const wordListContainer = document.getElementById('wordList');

  // --- å…§éƒ¨ç‹€æ…‹ ---
  let currentWord = null;
  let remainingSeconds = DEFAULT_SECONDS;
  let timerId = null;
  let isRunning = false;
  let score = 0;
  let attempts = 0;
  let askedCount = 0;
  let order = []; // éš¨æ©Ÿé¡Œåºï¼ˆindexï¼‰
  let allowSubmit = false;

  // --- åˆå§‹åŒ– UI / ç”¢ç”Ÿå­—æ¯æŒ‰éˆ• / åˆ—è¡¨ ---
  const palette = [
    '#ff6b6b','#ffd43b','#51cf66','#339af0','#845ef7','#ff922b','#16a34a','#ef476f','#06b6d4',
    '#f783ac','#7c3aed','#06d6a0','#f59e0b','#ff85a1'
  ];
  function randColor(i){
    return palette[i % palette.length];
  }

  function createLetterButtons(){
    lettersPanel.innerHTML = '';
    const Acode = 'A'.charCodeAt(0);
    for(let i=0;i<26;i++){
      const ch = String.fromCharCode(Acode + i);
      const div = document.createElement('div');
      div.className = 'letter';
      div.textContent = ch;
      div.setAttribute('data-letter', ch);
      const color = randColor(i);
      div.style.background = color;
      div.style.border = '3px solid rgba(255,255,255,0.08)';
      div.style.boxShadow = 'inset 0 -6px 12px rgba(0,0,0,0.06), 0 6px 12px rgba(10,30,80,0.06)';
      div.addEventListener('click', onLetterClick);
      lettersPanel.appendChild(div);
    }
  }

  function populateWordList(){
    wordListContainer.innerHTML = '';
    WORDS.forEach(w=>{
      const row = document.createElement('div');
      row.className = 'word-pair';
      row.innerHTML = '<div style="font-weight:800;color:#1b6fb3">'+ w.c +'</div><div style="font-weight:900;color:#2b8aef">'+ w.e +'</div>';
      wordListContainer.appendChild(row);
    });
  }

  // --- é¸é¡Œï¼ˆéš¨æ©Ÿç„¡é‡è¤‡ï¼‰---
  function prepareOrder(){
    const indices = WORDS.map((_,i)=>i);
    // Fisher-Yates shuffle
    for(let i=indices.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [indices[i], indices[j]] = [indices[j], indices[i]];
    }
    // å–å‰ QUESTION_COUNTï¼ˆæˆ–å…¨éƒ¨ï¼‰
    order = indices.slice(0, Math.min(QUESTION_COUNT, indices.length));
    askedCount = 0;
  }

  // --- é¡¯ç¤ºï¼ˆæ–°é¡Œï¼‰ ---
  function nextQuestion(){
    if(askedCount >= order.length){
      // å›åˆçµæŸ
      endRound();
      return;
    }
    const idx = order[askedCount];
    currentWord = WORDS[idx];
    chineseWord.textContent = currentWord.c;
    answerInput.value = '';
    typedDisplay.textContent = 'ï¼ˆç„¡ï¼‰';
    feedbackArea.textContent = 'è«‹è¼¸å…¥å®Œæ•´çš„è‹±æ–‡å–®å­—ï¼ŒæŒ‰æäº¤æˆ– Enterã€‚';
    feedbackArea.className = 'feedback';
    remainingSeconds = DEFAULT_SECONDS;
    updateTimerDisplay();
    enableSubmit(false);
    clearLetterSelection();
    answerInput.focus();
    askedCount++;
    updateProgress();
  }

  function updateProgress(){
    const pct = Math.round(( (askedCount-1) / order.length ) * 100);
    progressFill.style.width = pct + '%';
  }

  function endRound(){
    isRunning = false;
    clearInterval(timerId);
    timerId = null;
    feedbackArea.textContent = `æœ¬å›åˆçµæŸï¼å…±ç­”é¡Œ ${attempts} é¡Œï¼Œå¾—åˆ† ${score}ã€‚`;
    feedbackArea.className = 'feedback';
    chineseWord.textContent = 'å›åˆå·²çµæŸï¼ŒæŒ‰ã€Œé‡æ–°é–‹å§‹ã€æˆ–ã€Œé–‹å§‹ã€å†è©¦ä¸€æ¬¡';
    enableSubmit(false);
    startBtn.classList.remove('btn-disabled');
    answerInput.blur();
    progressFill.style.width = '100%';
  }

  function startRound(){
    score = 0;
    attempts = 0;
    scoreVal.textContent = '0';
    attemptVal.textContent = '0';
    prepareOrder();
    createLetterButtons();
    clearInterval(timerId);
    timerId = null;
    isRunning = true;
    startBtn.classList.add('btn-disabled');
    enableSubmit(false);
    nextQuestion();
    startTimer();
  }

  function restartRound(){
    // ä¿ç•™é¡Œåº«ä½†é‡æ–°é–‹å§‹æ–°å›åˆ
    startBtn.classList.remove('btn-disabled');
    prepareOrder();
    score = 0;
    attempts = 0;
    askedCount = 0;
    scoreVal.textContent = '0';
    attemptVal.textContent = '0';
    progressFill.style.width = '0%';
    feedbackArea.textContent = 'å·²é‡ç½®ï¼ŒæŒ‰é–‹å§‹ã€‚';
    feedbackArea.className = 'feedback';
    chineseWord.textContent = 'æŒ‰ã€Œé–‹å§‹ã€é¡¯ç¤ºé¡Œç›®';
    clearInterval(timerId);
    timerId = null;
    isRunning = false;
    enableSubmit(false);
    clearLetterSelection();
  }

  // --- è¨ˆæ™‚å™¨ ---
  function startTimer(){
    if(timerId) clearInterval(timerId);
    timerId = setInterval(()=>{
      remainingSeconds--;
      updateTimerDisplay();
      if(remainingSeconds <= 0){
        // æ™‚é–“åˆ°ï¼Œè¦–ç‚ºéŒ¯èª¤ä¸¦é€²å…¥ä¸‹ä¸€é¡Œ
        handleSubmit(true); // true è¡¨ç¤ºå› æ™‚é–“åˆ°è‡ªå‹•æäº¤ï¼ˆéŒ¯èª¤ï¼‰
      }
    }, 1000);
  }

  function updateTimerDisplay(){
    timeDisplay.textContent = String(remainingSeconds).padStart(2,'0');
  }

  // --- å­—æ¯é»æ“Šè™•ç† ---
  function onLetterClick(e){
    const letter = e.currentTarget.getAttribute('data-letter') || '';
    if(!letter) return;
    // æŠŠå­—æ¯é™„åŠ åˆ°è¼¸å…¥æ¡†
    answerInput.value = (answerInput.value + letter).slice(0, 30); // é™é•·
    typedDisplay.textContent = answerInput.value || 'ï¼ˆç„¡ï¼‰';
    // æŠŠè©²æŒ‰éˆ•æ”¹æˆ disabledï¼ˆé˜²æ­¢é‡è¤‡é»ï¼‰
    e.currentTarget.classList.add('disabled');
    enableSubmit(true);
    answerInput.focus();
  }

  function clearLetterSelection(){
    const els = lettersPanel.querySelectorAll('.letter');
    els.forEach(el=>el.classList.remove('disabled'));
  }

  // --- æäº¤/æª¢æŸ¥ç­”æ¡ˆ ---
  function enableSubmit(flag){
    allowSubmit = !!flag;
    if(allowSubmit){
      submitBtn.classList.remove('btn-disabled');
    } else {
      submitBtn.classList.add('btn-disabled');
    }
  }

  function handleSubmit(isTimeout=false){
    if(!isRunning) return;
    const typed = (answerInput.value || '').trim();
    const correct = currentWord ? currentWord.e.trim().toLowerCase() : '';
    attempts++;
    attemptVal.textContent = String(attempts);
    // åœè¨ˆæ™‚ä¸€å°æ®µæ™‚é–“é¡¯ç¤ºçµæœ
    clearInterval(timerId);
    timerId = null;
    if(!typed || isTimeout){
      // éŒ¯èª¤
      feedbackArea.textContent = `æ™‚é–“åˆ°æˆ–æœªè¼¸å…¥ï¼æ­£ç¢ºç­”æ¡ˆï¼š ${correct}`;
      feedbackArea.className = 'feedback bad';
    } else {
      if(typed.toLowerCase() === correct.toLowerCase()){
        score++;
        scoreVal.textContent = String(score);
        feedbackArea.textContent = 'ç­”å°äº†ï¼å¾ˆå¥½ ğŸ‘';
        feedbackArea.className = 'feedback ok';
      } else {
        feedbackArea.textContent = `ç­”éŒ¯äº†ï¼ä½ çš„ç­”æ¡ˆ: ${typed}ï¼›æ­£ç¢º: ${correct}`;
        feedbackArea.className = 'feedback bad';
      }
    }

    // é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆ 1.5 ç§’å¾Œé€²ä¸‹ä¸€é¡Œ
    setTimeout(()=>{
      // è‹¥é¡Œç›®åšå®Œå‰‡çµæŸ
      if(askedCount >= order.length){
        endRound();
        return;
      }
      // å¦å‰‡ä¸‹ä¸€é¡Œ
      nextQuestion();
      startTimer();
    }, 1200);
  }

  // --- é¡¯ç¤ºç­”æ¡ˆæç¤º ---
  function revealAnswer(){
    if(!currentWord) return;
    feedbackArea.textContent = `æç¤ºç­”æ¡ˆï¼š ${currentWord.e}`;
    feedbackArea.className = 'feedback';
  }

  // --- éµç›¤è™•ç†ï¼ˆè¼¸å…¥/Backspace/Enterï¼‰ ---
  answerInput.addEventListener('input', (e)=>{
    // è‹¥æœ‰è¼¸å…¥å‰‡å•Ÿç”¨æäº¤
    const v = e.target.value || '';
    typedDisplay.textContent = v ? v : 'ï¼ˆç„¡ï¼‰';
    // ç•¶ä½¿ç”¨éµç›¤è¼¸å…¥æ™‚ï¼Œè§£é™¤ letter æŒ‰éˆ• disabledï¼ˆé¿å…è·Ÿé»æ“Šæ··æ·†ï¼‰
    const els = lettersPanel.querySelectorAll('.letter');
    els.forEach(el=>el.classList.remove('disabled'));
    enableSubmit(!!v.trim());
  });

  answerInput.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){
      e.preventDefault();
      if(!submitBtn.classList.contains('btn-disabled')){
        handleSubmit(false);
      }
    }
    if(e.key === 'Escape'){
      answerInput.value = '';
      typedDisplay.textContent = 'ï¼ˆç„¡ï¼‰';
      enableSubmit(false);
    }
  });

  // å…¨åŸŸéµç›¤ï¼šè‹¥ä½¿ç”¨è€…ç›´æ¥æŒ‰ A~Zï¼Œä¹Ÿè¼¸å…¥åˆ°æ¬„ä½ï¼ˆä¸æœƒè§¸ç™¼å­—æ¯ disabledï¼‰
  document.addEventListener('keydown', (e)=>{
    if(!isRunning) return;
    const k = e.key;
    if(/^[a-zA-Z]$/.test(k)){
      answerInput.value = answerInput.value + k.toLowerCase();
      typedDisplay.textContent = answerInput.value;
      enableSubmit(!!answerInput.value.trim());
    }
    if(k === 'Backspace'){
      // ä¿æŒæ­£å¸¸ç€è¦½å™¨åˆªé™¤è¡Œç‚º
      // typedDisplay åœ¨ input event è£¡æœƒæ›´æ–°
    }
  });

  // --- äº‹ä»¶ç¶å®š ---
  startBtn.addEventListener('click', ()=>{
    if(startBtn.classList.contains('btn-disabled')) return;
    startRound();
  });
  restartBtn.addEventListener('click', ()=>{
    restartRound();
  });
  submitBtn.addEventListener('click', ()=>{
    if(submitBtn.classList.contains('btn-disabled')) return;
    handleSubmit(false);
  });
  showAnswerBtn.addEventListener('click', revealAnswer);

  // --- åˆå§‹åŒ– ---
  createLetterButtons();
  populateWordList();
  prepareOrder();
  updateTimerDisplay();
  enableSubmit(false);

  // é¡å¤–ï¼šåœ¨å°è¢å¹•ä¸Šè‡ªå‹•ç¸®çŸ­å­—æ¯æ’åˆ—ï¼ˆå·²ä½¿ç”¨ media queryï¼‰
})();
</script>
</body>
</html>